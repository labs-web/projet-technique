# Architecture de l'Application

Ce document détaille l'architecture technique de notre application Laravel. Nous suivons une architecture **MVC (Modèle-Vue-Contrôleur)** enrichie d'une **Couche Service** pour séparer la logique métier du code HTTP.

## 1. Vue d'Insemble : Le Flux de Données

## 2. Les Couches

### 2.1 Les Routes (`routes/web.php`)
- **Rôle** : Point d'entrée de l'application. Déclare les URLs et les verbes HTTP.
- **Règle** : Aucune logique (pas de closures). Elles pointent uniquement vers une méthode de Contrôleur.

### 2.2 Les Contrôleurs (`app/Http/Controllers`)
- **Rôle** : Chefs d'orchestre HTTP. Ils reçoivent la requête, valident les entrées, appellent le Service, et retournent une réponse (Vue ou JSON).
- **Principe** : "Skinny Controller". Ils ne doivent contenir **aucune** logique métier complexe.
- **Dépendances** : Ils injèctent les Services via le constructeur.

### 2.3 La Couche Service (`app/Services`)
- **Rôle** : Cœur de l'application. Contient toute la logique métier ("Business Logic").
- **Pourquoi ?** : Pour rendre le code réutilisable (appelable depuis un Contrôleur Web, une API, ou une commande Console) et testable.
- **Exemple** : `ArticleService` gère la création d'un article, l'upload d'image, et l'envoi de notification.

### 2.4 Les Modèles (`app/Models`)
- **Rôle** : Représentation des données et interaction avec la base de données (Eloquent ORM).
- **Règle** : "Fat Model" (modéré). Ils peuvent contenir des scopes, des accesseurs/mutateurs et des relations, mais pas de logique métier complexe (qui va dans le Service).

### 2.5 Les Vues (`resources/views`)
- **Rôle** : Présentation des données à l'utilisateur.
- **Organisation** :
  - **Layouts** : Structures de page globales (ex: `app.blade.php`).
  - **Pages** : Contenu spécifique à une route (ex: `articles/index.blade.php`).
  - **Partials** : Fragments réutilisables (ex: `_navbar.blade.php`, `_footer.blade.php`).
  - **Components** : Composants UI autonomes (ex: `<x-button>`, `<x-card>`).

## 3. Structure des Dossiers Clés

```text
/app
  /Http
    /Controllers    # Points d'entrée HTTP
    /Requests       # Validation des formulaires (FormRequest)
    /Resources      # Transformation des données API
  /Models           # Modèles Eloquent
  /Services         # Logique Métier (Notre ajout spécifique)

/resources
  /views
    /layouts        # Gabarits principaux
    /partials       # Morceaux de vues
    /components     # Composants Blade UI
    /articles       # Vues du module "Articles"
      index.blade.php   # Page : Liste des articles
      show.blade.php    # Page : Détail d'un article
      create.blade.php  # Page : Formulaire de création
      _form.blade.php   # Partial : Le formulaire (réutilisé pour create/edit)
      _card.blade.php   # Partial : La carte article pour la liste
```

## 4. Standard : Organisation des Vues CRUD

Pour chaque module CRUD (ex: Articles, Users), nous suivons **systématiquement** cette structure pour éviter la duplication de code :

### Les Pages (Contrôleurs)
*   `index.blade.php` : La liste principale.
*   `create.blade.php` : La page de création.
*   `edit.blade.php` : La page d'édition.
*   `show.blade.php` : La page de détail.

### Les Partials (Réutilisables)
Toute répétition de code doit être extraite dans un partial (préfixé par `_`).
*   `_form.blade.php` : Le formulaire (utilisé par `create` ET `edit`).
*   `_table.blade.php` (ou `_card.blade.php`) : L'élément d'affichage de la liste (utilisé par `index`, mais aussi dashboard, profil, etc.).
*   `_actions.blade.php` : Les boutons d'action (Voir, Éditer, Supprimer) pour centraliser la logique (modales, permissions).

## 5. Exemple Concret : Création d'un Article

1.  **Route** : `POST /articles` pointe vers `ArticleController@store`.
2.  **Request** : `ArticleStoreRequest` valide que le titre est présent.
3.  **Controller** : `ArticleController` appelle `$this->articleService->create($validatedData)`.
4.  **Service** : `ArticleService` :
    *   Crée l'instance du modèle `Article`.
    *   Sauvegarde en base.
    *   Déclenche une notification par email.
5.  **Controller** : Redirige l'utilisateur vers la liste des articles avec un message flash.
